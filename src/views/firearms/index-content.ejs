  <div class="action-bar">
    <div class="title-group">
      <h2>Inventory</h2>
      <small><%= items.length %> item<%= items.length === 1 ? '' : 's' %> on record</small>
    </div>
    <div style="display: flex; gap: 0.5rem;">
      <a class="btn btn-secondary" href="/firearms/export" download="firearms.csv">Export CSV</a>
      <a class="btn" href="/firearms/new">+ Add Firearm</a>
    </div>
  </div>

  <% if (items.length > 0) { %>
    <div class="search-container">
      <div class="search-controls">
        <input type="text" id="search-input" placeholder="Search firearms..." class="search-input" aria-label="Search firearms">
        <select id="search-field" class="search-select" aria-label="Choose a field to search">
          <option value="all">All Fields</option>
          <option value="make">Make</option>
          <option value="model">Model</option>
          <option value="caliber">Caliber</option>
          <option value="serial">Serial</option>
          <option value="purchase_date">Purchase Date</option>
          <option value="status">Status</option>
        </select>
      </div>
      <button type="button" class="btn btn-secondary" id="search-reset">Clear filters</button>
    </div>
  <% } %>

  <% if (!items.length) { %>
    <p>No firearms yet. Click "Add Firearm" to create one.</p>
  <% } else { %>
    <div class="table-wrapper">
      <div id="results-status" class="visually-hidden" role="status" aria-live="polite"></div>
      <table class="table">
        <thead>
          <tr>
            <th scope="col">
              <button class="table-sort" type="button" data-sort-key="make" aria-sort="none">
                <span>Make</span>
                <span class="sort-icon" aria-hidden="true">⇅</span>
              </button>
            </th>
            <th scope="col">
              <button class="table-sort" type="button" data-sort-key="model" aria-sort="none">
                <span>Model</span>
                <span class="sort-icon" aria-hidden="true">⇅</span>
              </button>
            </th>
            <th scope="col">
              <button class="table-sort" type="button" data-sort-key="caliber" aria-sort="none">
                <span>Caliber</span>
                <span class="sort-icon" aria-hidden="true">⇅</span>
              </button>
            </th>
            <th scope="col">
              <button class="table-sort" type="button" data-sort-key="serial" aria-sort="none">
                <span>Serial</span>
                <span class="sort-icon" aria-hidden="true">⇅</span>
              </button>
            </th>
            <th scope="col">
              <button class="table-sort" type="button" data-sort-key="purchase_date" aria-sort="none">
                <span>Purchase Date</span>
                <span class="sort-icon" aria-hidden="true">⇅</span>
              </button>
            </th>
            <th></th>
          </tr>
        </thead>
        <tbody id="firearms-tbody">
        <% items.forEach(i => { %>
          <tr data-make="<%= i.make %>" data-model="<%= i.model %>" data-caliber="<%= i.caliber || '' %>" data-serial="<%= i.serial || '' %>" data-status="<%= i.status || '' %>" data-purchase_date="<%= i.purchase_date || '' %>">
            <td><%= i.make %></td>
            <td><%= i.model %></td>
            <td><%= i.caliber || '' %></td>
            <td><%= i.serial || '' %></td>
            <td><%= i.purchase_date || '' %></td>
            <td class="text-right"><a class="btn btn-secondary" href="/firearms/<%= i.id %>">View</a></td>
          </tr>
        <% }) %>
        </tbody>
      </table>
      <div id="no-results" class="no-results" role="alert" aria-live="polite" hidden>
        <p>No matches found. Adjust your filters or clear them to see all firearms.</p>
      </div>
    </div>
  <% } %>

  <script src="/static/js/search.js"></script>
