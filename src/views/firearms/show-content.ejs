  <div class="item-header">
    <div class="item-title-block">
      <h2><%= item.make %> <%= item.model %></h2>
      <div class="badge-row">
        <span class="badge badge-accent"><%= item.status || 'Unknown Status' %></span>
        <span class="badge badge-outline"><%= item.firearm_type || 'Unknown Type' %></span>
      </div>
    </div>
    <div class="actions">
      <a class="btn" href="/firearms/<%= item.id %>/edit">Edit</a>
      <form id="delete-form" method="post" action="/firearms/<%= item.id %>/delete" style="display:inline">
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">
        <button class="btn btn-danger" type="button" onclick="showDeleteModal()">Delete</button>
      </form>
    </div>
  </div>

  <div class="item-toolbar">
    <a class="btn btn-secondary" href="/firearms">‚Üê Back to list</a>
    <a class="btn btn-secondary" href="/firearms/<%= item.id %>/duplicate">Duplicate</a>
    <button class="btn btn-secondary" type="button" onclick="window.print()">Print / Export</button>
  </div>

  <div class="detail-grid">
    <section class="detail-card">
      <header class="section-header">Profile</header>
      <dl class="details">
        <dt>Serial</dt><dd><%= item.serial || '-' %></dd>
        <dt>Caliber</dt><dd><%= item.caliber || '-' %></dd>
        <dt>Location</dt><dd><%= item.location || '-' %></dd>
        <dt>Notes</dt><dd><pre class="notes"><%= item.notes || '-' %></pre></dd>
      </dl>
    </section>

    <section class="detail-card">
      <header class="section-header">Ownership</header>
      <dl class="details">
        <dt>Status</dt><dd><%= item.status || '-' %></dd>
        <dt>Gun Warranty</dt><dd><%= item.gun_warranty === 1 ? 'Yes' : (item.gun_warranty === 0 ? 'No' : '-') %></dd>
      </dl>
    </section>

    <section class="detail-card">
      <header class="section-header">Purchase</header>
      <dl class="details">
        <dt>Purchase Date</dt><dd><%= item.purchase_date || '-' %></dd>
        <dt>Purchase Price</dt><dd><%= (item.purchase_price !== null && item.purchase_price !== undefined) ? ('$' + item.purchase_price) : '-' %></dd>
        <dt>Purchase Condition</dt><dd><%= item.condition || '-' %></dd>
      </dl>
    </section>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="delete-modal" class="modal-overlay" onclick="closeDeleteModalOnBackdrop(event)">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3 class="modal-title">Confirm Delete</h3>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete <strong><%= item.make %> <%= item.model %></strong>?</p>
        <p class="modal-warning">This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="button" onclick="closeDeleteModal()">Cancel</button>
        <button class="btn btn-danger" type="button" onclick="confirmDelete()">Delete</button>
      </div>
    </div>
  </div>

  <script>
    function showDeleteModal() {
      document.getElementById('delete-modal').classList.add('modal-active');
      document.body.style.overflow = 'hidden';
    }

    function closeDeleteModal() {
      document.getElementById('delete-modal').classList.remove('modal-active');
      document.body.style.overflow = '';
    }

    function closeDeleteModalOnBackdrop(event) {
      if (event.target === event.currentTarget) {
        closeDeleteModal();
      }
    }

    function confirmDelete() {
      document.getElementById('delete-form').submit();
    }
  </script>
